{
  "entities": {
    "College": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "College",
      "type": "object",
      "description": "Represents a college or university registered within the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the college entity."
        },
        "name": {
          "type": "string",
          "description": "The official name of the college."
        },
        "registrationDate": {
          "type": "string",
          "description": "The date when the college was registered in the application.",
          "format": "date-time"
        },
        "subscriptionFee": {
          "type": "number",
          "description": "The subscription fee amount for the college to use the application."
        }
      },
      "required": [
        "id",
        "name",
        "registrationDate",
        "subscriptionFee"
      ]
    },
    "Student": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Student",
      "type": "object",
      "description": "Represents a student user of the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the student entity."
        },
        "collegeId": {
          "type": "string",
          "description": "Reference to College. (Relationship: College 1:N Student)"
        },
        "email": {
          "type": "string",
          "description": "The student's email address.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "The student's full name."
        },
        "ratingIds": {
          "type": "array",
          "description": "References to Ratings. (Relationship: Rating N:N Student)",
          "items": {
            "type": "string"
          }
        },
        "googleId": {
          "type": "string",
          "description": "The student's google ID"
        }
      },
      "required": [
        "id",
        "collegeId",
        "email",
        "name",
        "googleId"
      ]
    },
    "ServiceRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ServiceRequest",
      "type": "object",
      "description": "Represents a service request posted by a student.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the service request entity."
        },
        "studentId": {
          "type": "string",
          "description": "Reference to Student. (Relationship: Student 1:N ServiceRequest)"
        },
        "serviceType": {
          "type": "string",
          "description": "The type of service requested (e.g., tutoring, design)."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the service request."
        },
        "deadline": {
          "type": "string",
          "description": "The deadline for the service request.",
          "format": "date-time"
        },
        "budget": {
          "type": "number",
          "description": "The budget allocated for the service request."
        }
      },
      "required": [
        "id",
        "studentId",
        "serviceType",
        "description",
        "deadline",
        "budget"
      ]
    },
    "ServiceProviderListing": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ServiceProviderListing",
      "type": "object",
      "description": "Represents a student listing their skills as a service provider.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the service provider listing entity."
        },
        "studentId": {
          "type": "string",
          "description": "Reference to Student. (Relationship: Student 1:N ServiceProviderListing)"
        },
        "skills": {
          "type": "string",
          "description": "A list of skills offered by the service provider."
        },
        "hourlyRate": {
          "type": "number",
          "description": "The hourly rate charged by the service provider."
        }
      },
      "required": [
        "id",
        "studentId",
        "skills",
        "hourlyRate"
      ]
    },
    "Payment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Payment",
      "type": "object",
      "description": "Represents a simulated payment transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the payment entity."
        },
        "payerId": {
          "type": "string",
          "description": "Reference to Student (payer). (Relationship: Student 1:N Payment)"
        },
        "payeeId": {
          "type": "string",
          "description": "Reference to Student (payee). (Relationship: Student 1:N Payment)"
        },
        "amount": {
          "type": "number",
          "description": "The amount of the payment."
        },
        "transactionDate": {
          "type": "string",
          "description": "The date and time of the payment transaction.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "payerId",
        "payeeId",
        "amount",
        "transactionDate"
      ]
    },
    "Rating": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Rating",
      "type": "object",
      "description": "Represents a rating given by one student to another.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the rating entity."
        },
        "raterId": {
          "type": "string",
          "description": "Reference to Student (rater). (Relationship: Student 1:N Rating)"
        },
        "rateeId": {
          "type": "string",
          "description": "Reference to Student (ratee). (Relationship: Student 1:N Rating)"
        },
        "ratingValue": {
          "type": "number",
          "description": "The rating value (e.g., 1 to 5 stars)."
        },
        "reviewText": {
          "type": "string",
          "description": "Optional text review accompanying the rating."
        }
      },
      "required": [
        "id",
        "raterId",
        "rateeId",
        "ratingValue"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/colleges/{collegeId}",
        "definition": {
          "entityName": "College",
          "schema": {
            "$ref": "#/backend/entities/College"
          },
          "description": "Stores college information. College management can create college profiles. Includes college ID as document ID.",
          "params": [
            {
              "name": "collegeId",
              "description": "The unique identifier for the college."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "Student",
          "schema": {
            "$ref": "#/backend/entities/Student"
          },
          "description": "Stores student profile information. Each student document is created upon signup. Includes student ID and Google ID.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the student."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/serviceRequests/{serviceRequestId}",
        "definition": {
          "entityName": "ServiceRequest",
          "schema": {
            "$ref": "#/backend/entities/ServiceRequest"
          },
          "description": "Stores service requests created by students. Each document is owned by a student.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the student (owner)."
            },
            {
              "name": "serviceRequestId",
              "description": "The unique identifier for the service request."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/serviceProviderListings/{serviceProviderListingId}",
        "definition": {
          "entityName": "ServiceProviderListing",
          "schema": {
            "$ref": "#/backend/entities/ServiceProviderListing"
          },
          "description": "Stores service provider listings created by students. Each document is owned by a student.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the student (owner)."
            },
            {
              "name": "serviceProviderListingId",
              "description": "The unique identifier for the service provider listing."
            }
          ]
        }
      },
      {
        "path": "/payments/{paymentId}",
        "definition": {
          "entityName": "Payment",
          "schema": {
            "$ref": "#/backend/entities/Payment"
          },
          "description": "Stores payment transaction information. No ownership, so this will require more complex rules.",
          "params": [
            {
              "name": "paymentId",
              "description": "The unique identifier for the payment."
            }
          ]
        }
      },
      {
        "path": "/ratings/{ratingId}",
        "definition": {
          "entityName": "Rating",
          "schema": {
            "$ref": "#/backend/entities/Rating"
          },
          "description": "Stores ratings given by students to other students. No ownership, so this will require more complex rules.",
          "params": [
            {
              "name": "ratingId",
              "description": "The unique identifier for the rating."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support the STUDORA application's core features, including college registration, student authentication, service marketplace, simulated payments, and ratings/reviews. The structure emphasizes authorization independence and QAPs. Google Authentication is integrated to make Student authentication seamless.\n\n**Authorization Independence (CRITICAL):** Denormalization is used to avoid hierarchical authorization dependencies. For example, the `students` subcollection under `colleges` denormalizes college-level information, making security rules independent of parent document reads.\n\n**QAPs (Rules are not Filters):** Structural segregation ensures secure list operations. Each collection has a clear security posture. For instance, student-owned service requests are located under `/users/{userId}/serviceRequests/{serviceRequestId}`, ensuring that only the student can manage them.\n\n**Access Modeling:** Path-based ownership is used for private data (e.g., `/users/{userId}/serviceRequests`). Membership maps are not explicitly required given the current feature set, but this could be expanded if collaborative features are introduced.\n\n**Invariants:** Timestamps and ownership can be enforced in security rules to maintain data integrity."
  }
}